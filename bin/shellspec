#!/usr/bin/env node
'use strict';

const ShellSpec = require('..');
const { readFileSync } = require('fs');
const Answers = require('answers');

(async () => {
    const config = await Answers({ name: 'shellspec' });
    const cmd = config._[1];
    const data = readFileSync(config._[0], 'utf8');
    if (data != null) {
        let spec;
        try {
            spec = JSON.parse(data);
        } catch (e) {
            process.stderr.write('{"error":"invalid JSON"}');
        }
        const loader = ShellSpec(spec);
        const argv = await loader.getPromptedArgv(config, { name: cmd });
        process.stdout.write(argv.join(' '));
    }
})();
